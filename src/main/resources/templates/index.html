<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>æ°´æœå•†åº—ç®¡ç†ç³»ç»Ÿ - é¦–é¡µ</title>
    <link rel="stylesheet" href="/fruitshop/resources/static/css/bootstrap.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
        }
        body {
            background-color: #f5f7fa;
            font-family: 'Microsoft YaHei', Arial, sans-serif;
        }
        .navbar {
            background:  linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            padding: 15px 0;
        }
        .navbar-brand {
            font-size: 22px;
            font-weight:  bold;
            color: white ! important;
        }
        . navbar-nav.nav-link {
            color: rgba(255, 255, 255, 0.8) !important;
            margin:  0 10px;
            transition: all 0.3s;
        }
        .navbar-nav . nav-link:hover {
            color: white !important;
        }
        .user-info {
            color: rgba(255, 255, 255, 0.9);
            font-size: 14px;
            margin-right: 20px;
        }
        . logout-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: 6px 15px;
            border-radius:  5px;
            cursor: pointer;
            transition: all 0.3s;
        }
        .logout-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            color: white;
        }
        .container-main {
            margin-top: 30px;
            margin-bottom: 30px;
        }
        . sidebar {
            background: white;
            border-radius: 8px;
            padding: 0;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            height: fit-content;
        }
        .sidebar . list-group-item {
            border:  none;
            border-bottom: 1px solid #eee;
            padding: 15px 20px;
            cursor: pointer;
            transition: all 0.3s;
            color: #333;
        }
        . sidebar .list-group-item:last-child {
            border-bottom: none;
        }
        .sidebar .list-group-item:hover {
            background-color: #f8f9fa;
            border-left: 4px solid #667eea;
            padding-left: 16px;
        }
        . sidebar .list-group-item. active {
            background-color:  #f8f9fa;
            border-left:  4px solid #667eea;
            padding-left: 16px;
            color: #667eea;
            font-weight: bold;
        }
        .card {
            border: none;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            transition: all 0.3s;
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow:  0 5px 15px rgba(0, 0, 0, 0.2);
        }
        .card-title {
            color: #333;
            font-weight: bold;
            font-size: 18px;
        }
        . btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
        }
        . btn-primary:hover {
            background: linear-gradient(135deg, #5568d3 0%, #653a91 100%);
            color:  white;
        }
        . stats-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        .stats-card-number {
            font-size: 32px;
            font-weight:  bold;
            color: #667eea;
        }
        .stats-card-label {
            color: #666;
            margin-top: 10px;
        }
        . table {
            background: white;
            border-radius: 8px;
        }
        .table thead {
            background: #f8f9fa;
        }
        .content-section {
            display: none;
        }
        .content-section.active {
            display: block;
        }
    </style>
</head>
<body>
<!-- å¯¼èˆªæ  -->
<nav class="navbar navbar-expand-lg navbar-dark">
    <div class="container-fluid">
        <a class="navbar-brand" href="javascript:void(0)">ğŸ æ°´æœå•†åº—ç®¡ç†ç³»ç»Ÿ</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ml-auto">
                <li class="nav-item">
                    <div class="user-info" id="userInfo">æ¬¢è¿ç™»å½•</div>
                </li>
                <li class="nav-item">
                    <button class="logout-btn" onclick="logout()">æ³¨é”€</button>
                </li>
            </ul>
        </div>
    </div>
</nav>

<!-- ä¸»å®¹å™¨ -->
<div class="container-fluid container-main">
    <div class="row">
        <!-- ä¾§è¾¹æ  -->
        <div class="col-md-2">
            <div class="sidebar">
                <div class="list-group">
                    <div class="list-group-item active" onclick="showSection('dashboard')">ğŸ“Š ä»ªè¡¨æ¿</div>
                    <div class="list-group-item" onclick="showSection('customers')">ğŸ‘¥ é¡¾å®¢ç®¡ç†</div>
                    <div class="list-group-item" onclick="showSection('fruits')">ğŸ“ æ°´æœç®¡ç†</div>
                    <div class="list-group-item" onclick="showSection('orders')">ğŸ“¦ è®¢å•ç®¡ç†</div>
                    <div class="list-group-item" onclick="showSection('suppliers')">ğŸ­ ä¾›åº”å•†ç®¡ç†</div>
                    <div class="list-group-item" onclick="showSection('vip')">â­ VIPç®¡ç†</div>
                </div>
            </div>
        </div>

        <!-- ä¸»å†…å®¹åŒº -->
        <div class="col-md-10">
            <!-- ä»ªè¡¨æ¿ -->
            <div id="dashboard" class="content-section active">
                <h2 style="margin-bottom: 30px;">ğŸ“Š ä»ªè¡¨æ¿</h2>

                <div class="row">
                    <div class="col-md-3">
                        <div class="stats-card">
                            <div class="stats-card-number" id="customerCount">0</div>
                            <div class="stats-card-label">æ€»é¡¾å®¢æ•°</div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="stats-card">
                            <div class="stats-card-number" id="fruitCount">0</div>
                            <div class="stats-card-label">æ°´æœç§ç±»</div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="stats-card">
                            <div class="stats-card-number" id="orderCount">0</div>
                            <div class="stats-card-label">æ€»è®¢å•æ•°</div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="stats-card">
                            <div class="stats-card-number" id="vipCount">0</div>
                            <div class="stats-card-label">VIPé¡¾å®¢</div>
                        </div>
                    </div>
                </div>

                <div class="row" style="margin-top: 30px;">
                    <div class="col-md-12">
                        <div class="card">
                            <div class="card-body">
                                <h5 class="card-title">ğŸ“ˆ ç³»ç»Ÿæ¦‚è§ˆ</h5>
                                <p style="color: #666; line-height: 1.8; margin-top: 15px;">
                                    æ¬¢è¿ä½¿ç”¨æ°´æœå•†åº—ç®¡ç†ç³»ç»Ÿï¼è¿™æ˜¯ä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„ä¼ä¸šçº§ç®¡ç†ç³»ç»Ÿï¼Œæä¾›äº†ï¼š<br>
                                    â€¢ é¡¾å®¢ä¿¡æ¯ç®¡ç†<br>
                                    â€¢ æ°´æœåº“å­˜ç®¡ç†<br>
                                    â€¢ è®¢å•å¤„ç†ç³»ç»Ÿ<br>
                                    â€¢ ä¾›åº”å•†ç®¡ç†<br>
                                    â€¢ VIPå®¢æˆ·æŠ˜æ‰£ç³»ç»Ÿ<br>
                                    <br>
                                    è¯·ä½¿ç”¨å·¦ä¾§èœå•é€‰æ‹©è¦è¿›è¡Œçš„æ“ä½œã€‚
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- å…¶ä»–å†…å®¹åŒº -->
            <div id="customers" class="content-section">
                <h2 style="margin-bottom: 20px;">ğŸ‘¥ é¡¾å®¢ç®¡ç†</h2>
                <div class="card">
                    <div class="card-body">
                        <p>é¡¾å®¢ç®¡ç†åŠŸèƒ½å‡†å¤‡ä¸­...</p>
                    </div>
                </div>
            </div>

            <div id="fruits" class="content-section">
                <h2 style="margin-bottom: 20px;">ğŸ“ æ°´æœç®¡ç†</h2>
                <div class="card">
                    <div class="card-body">
                        <p>æ°´æœç®¡ç†åŠŸèƒ½å‡†å¤‡ä¸­...</p>
                    </div>
                </div>
            </div>

            <div id="orders" class="content-section">
                <h2 style="margin-bottom: 20px;">ğŸ“¦ è®¢å•ç®¡ç†</h2>
                <div class="card">
                    <div class="card-body">
                        <p>è®¢å•ç®¡ç†åŠŸèƒ½å‡†å¤‡ä¸­...</p>
                    </div>
                </div>
            </div>

            <div id="suppliers" class="content-section">
                <h2 style="margin-bottom: 20px;">ğŸ­ ä¾›åº”å•†ç®¡ç†</h2>
                <div class="card">
                    <div class="card-body">
                        <p>ä¾›åº”å•†ç®¡ç†åŠŸèƒ½å‡†å¤‡ä¸­... </p>
                    </div>
                </div>
            </div>

            <div id="vip" class="content-section">
                <h2 style="margin-bottom: 20px;">â­ VIPç®¡ç†</h2>
                <div class="card">
                    <div class="card-body">
                        <p>VIPç®¡ç†åŠŸèƒ½å‡†å¤‡ä¸­...</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="/fruitshop/resources/static/js/jquery-3.6.4.min.js"></script>
<script src="/fruitshop/resources/static/js/bootstrap.bundle.min.js"></script>
<script src="/fruitshop/resources/static/js/axios.min.js"></script>

<script>
    const API_BASE = '/fruitshop/api';

    // é¡µé¢åˆå§‹åŒ–
    document.addEventListener('DOMContentLoaded', function() {
        loadCurrentUser();
        loadDashboardData();
    });

    // åŠ è½½å½“å‰ç”¨æˆ·ä¿¡æ¯
    function loadCurrentUser() {
        axios.get(API_BASE + '/auth/currentUser')
            .then(response => {
                if (response.data.code === 200) {
                    const user = response.data.data;
                    document.getElementById('userInfo').textContent =
                        `æ¬¢è¿ï¼Œ${user.remark || user.roleName}`;
                }
            })
            .catch(error => {
                console.log('ç”¨æˆ·æœªç™»å½•ï¼Œé‡å®šå‘åˆ°ç™»å½•é¡µé¢');
                window.location.href = '/fruitshop/login. html';
            });
    }

    // åŠ è½½ä»ªè¡¨æ¿æ•°æ®
    function loadDashboardData() {
        // é¡¾å®¢æ•°é‡
        axios. get(API_BASE + '/customer/list/all')
            .then(response => {
                if (response.data.code === 200) {
                    document.getElementById('customerCount').textContent = response.data.data.length;
                }
            })
            .catch(error => console.error('åŠ è½½é¡¾å®¢æ•°æ®å¤±è´¥:', error));

        // æ°´æœæ•°é‡
        axios.get(API_BASE + '/fruit/list/all')
            .then(response => {
                if (response.data.code === 200) {
                    document.getElementById('fruitCount').textContent = response.data.data.length;
                }
            })
            .catch(error => console.error('åŠ è½½æ°´æœæ•°æ®å¤±è´¥:', error));

        // è®¢å•æ•°é‡
        axios. get(API_BASE + '/order/list/all')
            .then(response => {
                if (response.data.code === 200) {
                    document.getElementById('orderCount').textContent = response.data.data.length;
                }
            })
            .catch(error => console.error('åŠ è½½è®¢å•æ•°æ®å¤±è´¥:', error));

        // VIPé¡¾å®¢æ•°é‡
        axios. get(API_BASE + '/customer/list/vip')
            .then(response => {
                if (response.data.code === 200) {
                    document.getElementById('vipCount').textContent = response.data.data.length;
                }
            })
            .catch(error => console.error('åŠ è½½VIPæ•°æ®å¤±è´¥:', error));
    }

    // æ˜¾ç¤ºå†…å®¹åŒº
    function showSection(sectionId) {
        // éšè—æ‰€æœ‰å†…å®¹åŒº
        document.querySelectorAll('.content-section').forEach(el => {
            el.classList. remove('active');
        });

        // ç§»é™¤æ‰€æœ‰èœå•é¡¹çš„activeç±»
        document.querySelectorAll('.sidebar .list-group-item').forEach(el => {
            el. classList.remove('active');
        });

        // æ˜¾ç¤ºé€‰ä¸­çš„å†…å®¹åŒº
        document.getElementById(sectionId).classList.add('active');

        // ç»™ç‚¹å‡»çš„èœå•é¡¹æ·»åŠ activeç±»
        event. target.classList.add('active');
    }

    // æ³¨é”€
    function logout() {
        if (confirm('ç¡®å®šè¦æ³¨é”€å—ï¼Ÿ')) {
            axios. post(API_BASE + '/auth/logout')
                .then(response => {
                    window.location.href = '/fruitshop/login.html';
                })
                .catch(error => {
                    window.location.href = '/fruitshop/login.html';
                });
        }
    }
</script>
</body>
</html>