<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>æ°´æœå•†åº—ç®¡ç†ç³»ç»Ÿ - é¦–é¡µ</title>
    <link rel="stylesheet" href="/fruitshop/resources/static/css/bootstrap.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            background-color: #f5f7fa;
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            color: #333;
        }
        .navbar {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1); /* æ›´ç»†è…»çš„å¯¼èˆªæ é˜´å½± */
            padding: 15px 0;
            position: sticky;
            top: 0;
            z-index: 999; /* å›ºå®šå¯¼èˆªæ  */
        }
        .navbar-brand {
            font-size: 22px;
            font-weight: bold;
            color: white !important;
            letter-spacing: 0.5px;
        }
        .navbar-nav .nav-link { /* ä¿®å¤å¤šä½™ç©ºæ ¼ */
            color: rgba(255, 255, 255, 0.8) !important;
            margin: 0 10px;
            transition: all 0.3s ease;
            padding: 8px 12px;
            border-radius: 6px; /* å¯¼èˆªé“¾æ¥åœ†è§’ */
        }
        .navbar-nav .nav-link:hover {
            color: white !important;
            background-color: rgba(255, 255, 255, 0.1); /* hover èƒŒæ™¯ */
        }
        .user-info {
            color: rgba(255, 255, 255, 0.9);
            font-size: 14px;
            margin-right: 20px;
            padding: 8px 0;
        }
        .logout-btn { /* ä¿®å¤å¤šä½™ç©ºæ ¼ */
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: 8px 18px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
        }
        .logout-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            color: white;
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        .container-main {
            margin-top: 30px;
            margin-bottom: 30px;
            padding: 0 15px;
        }
        .sidebar { /* ä¿®å¤å¤šä½™ç©ºæ ¼ */
            background: white;
            border-radius: 10px;
            padding: 0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            height: fit-content;
            overflow: hidden;
        }
        .sidebar .list-group-item { /* ä¿®å¤å¤šä½™ç©ºæ ¼ */
            border: none;
            border-bottom: 1px solid #f0f0f0;
            padding: 16px 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #555;
            font-size: 14px;
            position: relative;
            overflow: hidden;
        }
        .sidebar .list-group-item:last-child {
            border-bottom: none;
        }
        .sidebar .list-group-item:hover {
            background-color: #f8f9fa;
            border-left: 4px solid #667eea;
            padding-left: 16px;
            color: #667eea;
            transform: translateX(2px); /* è½»å¾®å³ç§» */
        }
        .sidebar .list-group-item.active { /* ä¿®å¤å¤šä½™ç©ºæ ¼ */
            background: linear-gradient(90deg, #f0f4ff 0%, #f8f9fa 100%);
            border-left: 4px solid #667eea;
            padding-left: 16px;
            color: #667eea;
            font-weight: bold;
        }
        /* ä¾§è¾¹æ item hover è£…é¥° */
        .sidebar .list-group-item::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 3px;
            height: 100%;
            background: #667eea;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        .sidebar .list-group-item:hover::before {
            opacity: 1;
        }
        .card {
            border: none;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            transition: all 0.4s ease;
            overflow: hidden;
            margin-bottom: 20px;
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12); /* å¢å¼ºhoveré˜´å½± */
        }
        .card-title {
            color: #333;
            font-weight: bold;
            font-size: 18px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .card-title::before {
            content: "";
            width: 4px;
            height: 20px;
            background: #667eea;
            border-radius: 2px;
        }
        .card-body {
            padding: 25px;
        }
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            border-radius: 8px;
            padding: 8px 20px;
            transition: all 0.3s ease;
        }
        .btn-primary:hover {
            background: linear-gradient(135deg, #5a6edb 0%, #6b4190 100%);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(102,126,234,0.2);
        }
        .stats-card {
            background: linear-gradient(135deg, #ffffff 0%, #f8f9ff 100%);
            padding: 25px 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
            border: 1px solid #f0f4ff;
        }
        .stats-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 16px rgba(102,126,234,0.1);
        }
        .stats-card-number {
            font-size: 36px;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 8px;
            transition: all 0.5s ease;
        }
        .stats-card:hover .stats-card-number {
            transform: scale(1.05); /* æ•°å­—è½»å¾®æ”¾å¤§ */
        }
        .stats-card-label {
            color: #666;
            margin-top: 8px;
            font-size: 14px;
            letter-spacing: 0.3px;
        }
        .table {
            background: white;
            border-radius: 10px;
            overflow: hidden; /* è®©åœ†è§’ç”Ÿæ•ˆ */
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }
        .table thead {
            background: linear-gradient(90deg, #f8f9fa 0%, #f0f4ff 100%);
        }
        .table th {
            border: none;
            padding: 15px;
            color: #555;
            font-weight: 600;
        }
        .table td {
            border-color: #f0f0f0;
            padding: 15px;
        }
        .content-section {
            display: none;
            animation: sectionFade 0.4s ease-in-out; /* å†…å®¹åˆ‡æ¢åŠ¨ç”» */
        }
        @keyframes sectionFade {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .content-section.active {
            display: block;
        }
        h2 {
            color: #333;
            font-weight: 600;
            margin-bottom: 30px;
            position: relative;
            padding-bottom: 10px;
        }
        h2::after {
            content: "";
            position: absolute;
            left: 0;
            bottom: 0;
            width: 60px;
            height: 3px;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            border-radius: 3px;
        }
        /* ç§»åŠ¨ç«¯é€‚é… */
        @media (max-width: 768px) {
            .sidebar {
                margin-bottom: 20px;
            }
            .stats-card-number {
                font-size: 28px;
            }
            .card-body {
                padding: 20px 15px;
            }
            .navbar-brand {
                font-size: 18px;
            }
            .user-info {
                margin-right: 10px;
                font-size: 13px;
            }
            .logout-btn {
                padding: 6px 12px;
                font-size: 13px;
            }
        }
    </style>
</head>
<body>
<!-- å¯¼èˆªæ  -->
<nav class="navbar navbar-expand-lg navbar-dark">
    <div class="container-fluid">
        <a class="navbar-brand" href="javascript:void(0)">ğŸ æ°´æœå•†åº—ç®¡ç†ç³»ç»Ÿ</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ml-auto">
                <li class="nav-item">
                    <div class="user-info" id="userInfo">æ¬¢è¿ç™»å½•</div>
                </li>
                <li class="nav-item">
                    <button class="logout-btn" onclick="logout()">æ³¨é”€</button>
                </li>
            </ul>
        </div>
    </div>
</nav>

<!-- ä¸»å®¹å™¨ -->
<div class="container-fluid container-main">
    <div class="row">
        <!-- ä¾§è¾¹æ  -->
        <div class="col-md-2">
            <div class="sidebar">
                <div class="list-group">
                    <div class="list-group-item active" onclick="showSection('dashboard')">ğŸ“Š ä»ªè¡¨æ¿</div>
                    <div class="list-group-item" onclick="showSection('customers')">ğŸ‘¥ é¡¾å®¢ç®¡ç†</div>
                    <div class="list-group-item" onclick="showSection('fruits')">ğŸ“ æ°´æœç®¡ç†</div>
                    <div class="list-group-item" onclick="showSection('orders')">ğŸ“¦ è®¢å•ç®¡ç†</div>
                    <div class="list-group-item" onclick="showSection('suppliers')">ğŸ­ ä¾›åº”å•†ç®¡ç†</div>
                    <div class="list-group-item" onclick="showSection('vip')">â­ VIPç®¡ç†</div>
                </div>
            </div>
        </div>

        <!-- ä¸»å†…å®¹åŒº -->
        <div class="col-md-10">
            <!-- ä»ªè¡¨æ¿ -->
            <div id="dashboard" class="content-section active">
                <h2>ğŸ“Š ä»ªè¡¨æ¿</h2>

                <div class="row">
                    <div class="col-md-3">
                        <div class="stats-card">
                            <div class="stats-card-number" id="customerCount">0</div>
                            <div class="stats-card-label">æ€»é¡¾å®¢æ•°</div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="stats-card">
                            <div class="stats-card-number" id="fruitCount">0</div>
                            <div class="stats-card-label">æ°´æœç§ç±»</div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="stats-card">
                            <div class="stats-card-number" id="orderCount">0</div>
                            <div class="stats-card-label">æ€»è®¢å•æ•°</div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="stats-card">
                            <div class="stats-card-number" id="vipCount">0</div>
                            <div class="stats-card-label">VIPé¡¾å®¢</div>
                        </div>
                    </div>
                </div>

                <div class="row" style="margin-top: 30px;">
                    <div class="col-md-12">
                        <div class="card">
                            <div class="card-body">
                                <h5 class="card-title">ğŸ“ˆ ç³»ç»Ÿæ¦‚è§ˆ</h5>
                                <p style="color: #666; line-height: 1.8; margin-top: 15px; font-size: 14px;">
                                    æ¬¢è¿ä½¿ç”¨æ°´æœå•†åº—ç®¡ç†ç³»ç»Ÿï¼è¿™æ˜¯ä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„ä¼ä¸šçº§ç®¡ç†ç³»ç»Ÿï¼Œæä¾›äº†ï¼š<br>
                                    â€¢ é¡¾å®¢ä¿¡æ¯ç®¡ç†ï¼ˆæ–°å¢ã€ç¼–è¾‘ã€æŸ¥è¯¢ã€VIPæ ‡è®°ï¼‰<br>
                                    â€¢ æ°´æœåº“å­˜ç®¡ç†ï¼ˆåº“å­˜é¢„è­¦ã€ä»·æ ¼è°ƒæ•´ã€åˆ†ç±»ç®¡ç†ï¼‰<br>
                                    â€¢ è®¢å•å¤„ç†ç³»ç»Ÿï¼ˆä¸‹å•ã€æ”¯ä»˜ã€å‘è´§ã€é€€æ¬¾ï¼‰<br>
                                    â€¢ ä¾›åº”å•†ç®¡ç†ï¼ˆèµ„è´¨å®¡æ ¸ã€åˆä½œçŠ¶æ€ã€ä¾›è´§è®°å½•ï¼‰<br>
                                    â€¢ VIPå®¢æˆ·æŠ˜æ‰£ç³»ç»Ÿï¼ˆç­‰çº§è®¾ç½®ã€æŠ˜æ‰£è§„åˆ™ã€æ¶ˆè´¹ç»Ÿè®¡ï¼‰<br>
                                    <br>
                                    è¯·ä½¿ç”¨å·¦ä¾§èœå•é€‰æ‹©è¦è¿›è¡Œçš„æ“ä½œï¼Œæ‰€æœ‰æ“ä½œæ•°æ®å°†å®æ—¶åŒæ­¥è‡³æœåŠ¡å™¨ã€‚
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- å…¶ä»–å†…å®¹åŒº -->
            <div id="customers" class="content-section">
                <h2>ğŸ‘¥ é¡¾å®¢ç®¡ç†</h2>
                <div class="card">
                    <div class="card-body">
                        <p style="color: #666; font-size: 14px; line-height: 1.6;">é¡¾å®¢ç®¡ç†åŠŸèƒ½å‡†å¤‡ä¸­...<br>
                            å³å°†æ”¯æŒï¼šé¡¾å®¢ä¿¡æ¯æŸ¥è¯¢ã€æ–°å¢é¡¾å®¢ã€ç¼–è¾‘é¡¾å®¢èµ„æ–™ã€æ ‡è®°VIPé¡¾å®¢ã€å¯¼å‡ºé¡¾å®¢åˆ—è¡¨ç­‰åŠŸèƒ½ã€‚</p>
                    </div>
                </div>
            </div>

            <div id="fruits" class="content-section">
                <h2>ğŸ“ æ°´æœç®¡ç†</h2>
                <div class="card">
                    <div class="card-body">
                        <p style="color: #666; font-size: 14px; line-height: 1.6;">æ°´æœç®¡ç†åŠŸèƒ½å‡†å¤‡ä¸­...<br>
                            å³å°†æ”¯æŒï¼šæ°´æœä¿¡æ¯å½•å…¥ã€åº“å­˜ç®¡ç†ã€ä»·æ ¼è°ƒæ•´ã€åˆ†ç±»ç®¡ç†ã€åº“å­˜é¢„è­¦æé†’ç­‰åŠŸèƒ½ã€‚</p>
                    </div>
                </div>
            </div>

            <div id="orders" class="content-section">
                <h2>ğŸ“¦ è®¢å•ç®¡ç†</h2>
                <div class="card">
                    <div class="card-body">
                        <p style="color: #666; font-size: 14px; line-height: 1.6;">è®¢å•ç®¡ç†åŠŸèƒ½å‡†å¤‡ä¸­...<br>
                            å³å°†æ”¯æŒï¼šè®¢å•æŸ¥è¯¢ã€è®¢å•çŠ¶æ€æ›´æ–°ã€å‘è´§ç®¡ç†ã€é€€æ¬¾å¤„ç†ã€è®¢å•ç»Ÿè®¡åˆ†æç­‰åŠŸèƒ½ã€‚</p>
                    </div>
                </div>
            </div>

            <div id="suppliers" class="content-section">
                <h2>ğŸ­ ä¾›åº”å•†ç®¡ç†</h2>
                <div class="card">
                    <div class="card-body">
                        <p style="color: #666; font-size: 14px; line-height: 1.6;">ä¾›åº”å•†ç®¡ç†åŠŸèƒ½å‡†å¤‡ä¸­...<br>
                            å³å°†æ”¯æŒï¼šä¾›åº”å•†ä¿¡æ¯å½•å…¥ã€èµ„è´¨å®¡æ ¸ã€åˆä½œçŠ¶æ€ç®¡ç†ã€ä¾›è´§è®°å½•æŸ¥è¯¢ç­‰åŠŸèƒ½ã€‚</p>
                    </div>
                </div>
            </div>

            <div id="vip" class="content-section">
                <h2>â­ VIPç®¡ç†</h2>
                <div class="card">
                    <div class="card-body">
                        <p style="color: #666; font-size: 14px; line-height: 1.6;">VIPç®¡ç†åŠŸèƒ½å‡†å¤‡ä¸­...<br>
                            å³å°†æ”¯æŒï¼šVIPç­‰çº§è®¾ç½®ã€æŠ˜æ‰£è§„åˆ™é…ç½®ã€VIPæ¶ˆè´¹ç»Ÿè®¡ã€ä¸“å±æƒç›Šç®¡ç†ç­‰åŠŸèƒ½ã€‚</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="/fruitshop/resources/static/js/jquery-3.6.4.min.js"></script>
<script src="/fruitshop/resources/static/js/bootstrap.bundle.min.js"></script>
<script src="/fruitshop/resources/static/js/axios.min.js"></script>

<script>
    const API_BASE = '/fruitshop/api';

    // é¡µé¢åˆå§‹åŒ–
    document.addEventListener('DOMContentLoaded', function() {
        loadCurrentUser();
        loadDashboardData();
    });

    // åŠ è½½å½“å‰ç”¨æˆ·ä¿¡æ¯
    function loadCurrentUser() {
        axios.get(API_BASE + '/auth/currentUser')
            .then(response => {
                if (response.data.code === 200) {
                    const user = response.data.data;
                    document.getElementById('userInfo').textContent =
                        `æ¬¢è¿ï¼Œ${user.remark || user.roleName}`;
                }
            })
            .catch(error => {
                console.log('ç”¨æˆ·æœªç™»å½•ï¼Œé‡å®šå‘åˆ°ç™»å½•é¡µé¢');
                window.location.href = '/fruitshop/login.html'; // ä¿®å¤ç©ºæ ¼
            });
    }

    // åŠ è½½ä»ªè¡¨æ¿æ•°æ®
    function loadDashboardData() {
        // é¡¾å®¢æ•°é‡
        axios.get(API_BASE + '/customer/list/all') // ä¿®å¤ç©ºæ ¼
            .then(response => {
                if (response.data.code === 200) {
                    animateNumber('customerCount', 0, response.data.data.length, 1000);
                }
            })
            .catch(error => console.error('åŠ è½½é¡¾å®¢æ•°æ®å¤±è´¥:', error));

        // æ°´æœæ•°é‡
        axios.get(API_BASE + '/fruit/list/all')
            .then(response => {
                if (response.data.code === 200) {
                    animateNumber('fruitCount', 0, response.data.data.length, 1000);
                }
            })
            .catch(error => console.error('åŠ è½½æ°´æœæ•°æ®å¤±è´¥:', error));

        // è®¢å•æ•°é‡
        axios.get(API_BASE + '/order/list/all') // ä¿®å¤ç©ºæ ¼
            .then(response => {
                if (response.data.code === 200) {
                    animateNumber('orderCount', 0, response.data.data.length, 1000);
                }
            })
            .catch(error => console.error('åŠ è½½è®¢å•æ•°æ®å¤±è´¥:', error));

        // VIPé¡¾å®¢æ•°é‡
        axios.get(API_BASE + '/customer/list/vip') // ä¿®å¤ç©ºæ ¼
            .then(response => {
                if (response.data.code === 200) {
                    animateNumber('vipCount', 0, response.data.data.length, 1000);
                }
            })
            .catch(error => console.error('åŠ è½½VIPæ•°æ®å¤±è´¥:', error));
    }

    // æ•°å­—åŠ¨ç”»æ•ˆæœ
    function animateNumber(id, start, end, duration) {
        const element = document.getElementById(id);
        const range = end - start;
        const stepTime = Math.abs(Math.floor(duration / range));
        let current = start;
        const timer = setInterval(() => {
            current += 1;
            element.textContent = current;
            if (current === end) {
                clearInterval(timer);
            }
        }, stepTime);
    }

    // æ˜¾ç¤ºå†…å®¹åŒº
    function showSection(sectionId) {
        // éšè—æ‰€æœ‰å†…å®¹åŒº
        document.querySelectorAll('.content-section').forEach(el => {
            el.classList.remove('active'); // ä¿®å¤ç©ºæ ¼
        });

        // ç§»é™¤æ‰€æœ‰èœå•é¡¹çš„activeç±»
        document.querySelectorAll('.sidebar .list-group-item').forEach(el => {
            el.classList.remove('active'); // ä¿®å¤ç©ºæ ¼
        });

        // æ˜¾ç¤ºé€‰ä¸­çš„å†…å®¹åŒº
        document.getElementById(sectionId).classList.add('active');

        // ç»™ç‚¹å‡»çš„èœå•é¡¹æ·»åŠ activeç±»
        event.target.classList.add('active');
    }

    // æ³¨é”€
    function logout() {
        if (confirm('ç¡®å®šè¦æ³¨é”€å—ï¼Ÿ')) {
            axios.post(API_BASE + '/auth/logout') // ä¿®å¤ç©ºæ ¼
                .then(response => {
                    window.location.href = '/fruitshop/login.html';
                })
                .catch(error => {
                    window.location.href = '/fruitshop/login.html';
                });
        }
    }
</script>
</body>
</html>