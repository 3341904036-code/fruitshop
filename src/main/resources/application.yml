spring:
  application:
    name: fruitshop-manager

  # 数据库配置
  datasource:
    type: com.alibaba.druid.pool.DruidDataSource
    url: jdbc:mysql://localhost:3306/fruitshop? useUnicode=true&characterEncoding=UTF-8&serverTimezone=UTC&allowMultiQueries=true
    username: root
    password: 123456
    driver-class-name:  com.mysql.cj.jdbc.Driver
    druid:
      initial-size: 5
      min-idle:  5
      max-active: 20
      max-wait: 60000
      time-between-eviction-runs-millis: 60000
      min-evictable-idle-time-millis: 300000
      validation-query: SELECT 1 FROM DUAL
      test-while-idle: true
      test-on-borrow: false
      test-on-return:   false
      pool-prepared-statements: true
      max-open-prepared-statements: 20
      use-global-data-source-stat: true
      name: DruidDataSource
      filters: stat,wall,log4j

  # JPA配置
  jpa:
    hibernate:
      ddl-auto: none
    show-sql: false

  # MVC配置
  mvc:
    static-path-pattern: /static/**
    throw-exception-if-no-handler-found: true

  # 静态资源配置
  web:
    resources:
      static-locations: classpath:/static/
      add-mappings: true

  # Thymeleaf配置 - 重要！
  thymeleaf:
    # 模板前缀路径（必须）
    prefix: classpath:/templates/
    # 模板后缀
    suffix: .html
    # 编码
    encoding: UTF-8
    # 模式
    mode: HTML
    # 禁用缓存（开发模式）
    cache: false
    # 禁用模板位置检查警告
    check-template-location: false
    # 启用MVC Thymeleaf视图解析器
    enabled: true

  # MyBatis-Plus配置
mybatis-plus:
  mapper-locations: classpath:/mapper/*. xml
  type-aliases-package: com.fruitshop.entity
  configuration:
    map-underscore-to-camel-case: true
    log-impl: org.apache.ibatis.logging.stdout.StdOutImpl
    call-setters-on-nulls: true
  global-config:
    db-config:
      id-type: AUTO
      table-underline:   true

# 日志配置
logging:
  level:
    root: INFO
    com.fruitshop: DEBUG
    org.springframework. web: INFO
    org.springframework.security: DEBUG
    org.springframework.thymeleaf: DEBUG
    com.baomidou. mybatisplus: DEBUG
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"
    file: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"
  file:
    name: logs/fruitshop. log

# 服务器配置
server:
  port: 8080
  servlet:
    context-path: /fruitshop
    session:
      timeout: 30m
      cookie:
        http-only: true
        secure:   false
  tomcat:
    max-threads: 200
    min-spare-threads: 10
    max-connections: 20000
    accept-count: 100

# 管理端点
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics
  endpoint:
    health:
      show-details: always